---
name: تنظيم كيانات المعلم والطالب
overview: تقسيم ملف teacher_tables.cs إلى ملفات منظمة حسب هيكل المشروع الحالي، وإنشاء كيان الطالب (Student) المرتبط بـ User مع معلومات ولي الأمر.
todos:
  - id: create-enums
    content: Create TeachingEnums.cs with all shared enums
    status: pending
  - id: create-student
    content: Create Student and Guardian entities with navigation properties
    status: pending
  - id: create-teacher-folder
    content: Create Teacher folder with 9 entity files
    status: pending
  - id: create-course-folder
    content: Create Course folder with 7 entity files
    status: pending
  - id: create-session-folder
    content: Create Session folder with 4 entity files
    status: pending
  - id: create-payment-folder
    content: Create Payment folder with 3 entity files
    status: pending
  - id: create-dayofweek
    content: Create DayOfWeekMaster.cs in Common folder
    status: pending
  - id: update-dbcontext
    content: Update ApplicationDBContext with new DbSets
    status: pending
  - id: delete-old-file
    content: Delete teacher_tables.cs after verification
    status: pending
---

# تنظيم كيانات المعلم وإنشاء كيان الطالب

## الهيكل المستهدف

```
Qalam.Data/Entity/
├── Common/
│   ├── DayOfWeekMaster.cs          (جديد)
│   └── Enums/
│       └── TeachingEnums.cs        (جديد - جميع الـ Enums)
│
├── Student/                         (مجلد جديد)
│   ├── Student.cs                   (جديد)
│   └── Guardian.cs                  (جديد - ولي الأمر)
│
├── Teacher/                         (مجلد جديد)
│   ├── Teacher.cs
│   ├── TeacherDocument.cs
│   ├── TeacherSubject.cs            (نقل من Education)
│   ├── TeacherSubjectUnit.cs
│   ├── TeacherAvailability.cs
│   ├── TeacherAvailabilityException.cs
│   ├── TeacherArea.cs
│   ├── TeacherReview.cs
│   └── TeacherAuditLog.cs
│
├── Course/                          (مجلد جديد)
│   ├── Course.cs
│   ├── CourseSession.cs
│   ├── CourseEnrollmentRequest.cs
│   ├── CourseRequestSelectedAvailability.cs
│   ├── CourseRequestGroupMember.cs
│   ├── CourseEnrollment.cs
│   └── CourseSchedule.cs
│
├── Session/                         (مجلد جديد)
│   ├── SessionRequest.cs
│   ├── SessionRequestOffer.cs
│   ├── Session.cs
│   └── ScheduledSession.cs
│
└── Payment/                         (مجلد جديد)
    ├── Payment.cs
    ├── PaymentItem.cs
    └── CourseEnrollmentPayment.cs
```

## كيان الطالب (Student)

```csharp
public class Student : AuditableEntity
{
    public int Id { get; set; }
    public int UserId { get; set; }  // FK to User
    
    // المعلومات التعليمية
    public int? DomainId { get; set; }
    public int? CurriculumId { get; set; }
    public int? LevelId { get; set; }
    public int? GradeId { get; set; }
    
    // المعلومات الشخصية
    public DateOnly? DateOfBirth { get; set; }
    public Gender? Gender { get; set; }
    public string? SchoolName { get; set; }
    
    // علاقة ولي الأمر
    public int? GuardianId { get; set; }
    
    // Navigation
    public User User { get; set; }
    public Guardian? Guardian { get; set; }
}
```

## كيان ولي الأمر (Guardian)

```csharp
public class Guardian : AuditableEntity
{
    public int Id { get; set; }
    public int? UserId { get; set; }  // إذا كان له حساب
    
    public string FullName { get; set; }
    public string Phone { get; set; }
    public string? Email { get; set; }
    public GuardianRelation Relation { get; set; }  // أب، أم، أخ، أخرى
    
    // Navigation
    public ICollection<Student> Students { get; set; }
}
```

## التغييرات المطلوبة

### 1. الملفات الجديدة

- حذف [`Qalam.Data/Entity/teacher_tables.cs`](Qalam.Data/Entity/teacher_tables.cs) بعد التقسيم
- إنشاء 25+ ملف كيان منظم

### 2. تحديث ApplicationDBContext

- إضافة DbSets للكيانات الجديدة (Student, Guardian, Teacher, Course, etc.)
- إضافة الـ using statements المطلوبة

### 3. إنشاء Configurations

- إنشاء ملفات IEntityTypeConfiguration لكل كيان في `Qalam.Infrastructure/Configurations/`
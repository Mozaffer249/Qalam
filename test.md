## ๐ฏ ุงูุณููุงุฑูู ุงูุฃุณูู ูุงูุฃูุซุฑ ูุฑููุฉ

ุงูุณููุงุฑูู ุงูุฃุณูู ูู **ูุตู ุงูุฃุฏูุงุฑ (Roles)** ูุงูุณูุงุญ ูุญุณุงุจ `User` ุงููุงุญุฏ ุฃู ูููู ูู **ุนุฏุฉ ุฃุฏูุงุฑ** ูู ููุณ ุงูููุช. ุฏุนูู ุฃุดุฑุญ ุงูุญุงูุงุช ุงููุฎุชููุฉ:

---

## ๐ ุงูุญุงูุงุช ุงููุญุชููุฉ:

### **1๏ธโฃ ุทุงูุจ ุจุงูุบ (ุนุงูู) - ูุชุนูู ูููุณู**
```
User (ุญุณุงุจ ุฃุณุงุณู)
  โโโ Student (IsMinor = false, GuardianId = null)
```
- ูุฏูู ุญุณุงุจ `User` ูู ุงููุธุงู
- ูุฏูู ููู `Student` ูุฑุชุจุท ุจู
- **ูุง ูุญุชุงุฌ** `Guardian` ูุฃูู ุจุงูุบ

**ูุซุงู:** ุดุงุจ ุนูุฑู 25 ุณูุฉ ูุฑูุฏ ุชุนูู ุงููุฑุขู

---

### **2๏ธโฃ ููู ุฃูุฑ - ูุณุฌู ูุฃุทูุงูู ููุท**
```
User (ุญุณุงุจ ุฃุณุงุณู)
  โโโ Guardian
       โโโ Student 1 (ุทูู ุฃูู - IsMinor = true)
       โโโ Student 2 (ุทูู ุซุงูู - IsMinor = true)
       โโโ Student 3 (ุทูู ุซุงูุซ - IsMinor = true)
```
- ูุฏูู ุญุณุงุจ `User` ูู ุงููุธุงู
- ูุฏูู ููู `Guardian` ูุฑุชุจุท ุจู
- **ูุง ููุฌุฏ** ููู `Student` ูู (ูุฃูู ูุง ูุฑูุฏ ุงูุชุนูู)
- ููุดุฆ ุญุณุงุจุงุช `User` ูุฃุทูุงููุ ููููุงุช `Student` ูุฑุชุจุทุฉ ุจูู

**ูุซุงู:** ุฃุจ ูุฏูู 3 ุฃุทูุงูุ ูุณุฌููู ุฌููุนุงู ููุชุนูู

---

### **3๏ธโฃ ุทุงูุจ ุจุงูุบ + ููู ุฃูุฑ - ูุชุนูู ููุฏูู ุฃุทูุงู** โญ (ุงูุฃูู)
```
User (ุญุณุงุจ ุฃุณุงุณู)
  โโโ Student (ูููุณู - IsMinor = false, GuardianId = null)
  โโโ Guardian (ูุฃุทูุงูู)
       โโโ Student (ุทูู ุฃูู - IsMinor = true)
       โโโ Student (ุทูู ุซุงูู - IsMinor = true)
```
- ูุฏูู ุญุณุงุจ `User` ูุงุญุฏ ูู ุงููุธุงู
- ูุฏูู ููู `Student` **ูููุณู** (ูุฃูู ูุฑูุฏ ุงูุชุนูู)
- ูุฏูู ููู `Guardian` **ูุฃุทูุงูู**
- ุฃุทูุงูู ููู ุญุณุงุจุงุช `User` ูููุตูุฉ ููููุงุช `Student`

**ูุซุงู:** ุฃู ุนูุฑูุง 35 ุณูุฉ ุชุฑูุฏ ุชุนูู ุงููุฑุขูุ ููุฏููุง ุทููุงู ุชุฑูุฏ ุชุณุฌููููุง ุฃูุถุงู

---

### **4๏ธโฃ ุทุงูุจ ูุงุตุฑ (ุทูู)**
```
User (ุญุณุงุจ ุฃุณุงุณู ููุทูู)
  โโโ Student (IsMinor = true, GuardianId = [ูุนุฑู ููู ุงูุฃูุฑ])
       โโโ Guardian (ุญุณุงุจ ููู ุงูุฃูุฑ)
```
- ูุฏูู ุญุณุงุจ `User` ุฎุงุต ุจู
- ูุฏูู ููู `Student` ูุฑุชุจุท ุจู `Guardian`
- ููู ุงูุฃูุฑ ูุฏูู ุญุณุงุจ `User` ูููุตู ูููู `Guardian`

**ูุซุงู:** ุทูู ุนูุฑู 10 ุณููุงุชุ ูุณุฌู ูู ูุจู ูุงูุฏู

---

## โ ุงูุชุตููู ุงูุฃุณูู (ุงูุชูุตูุฉ):

### **๐น ุงูุจููุฉ:**

```sql
User (ุงูุญุณุงุจ ุงูุฃุณุงุณู)
โโโ Id
โโโ UserName
โโโ Email
โโโ Roles: ["Student", "Guardian", "Teacher", ...]
    
Student (ููู ุงูุทุงูุจ)
โโโ Id
โโโ UserId โ User (ุญุณุงุจ ุตุงุญุจ ุงูููู)
โโโ IsMinor (ูู ูุงุตุฑุ)
โโโ GuardianId โ Guardian (ุฅุฐุง ูุงู ูุงุตุฑ)
โโโ GuardianRelation (ููุน ุงูุนูุงูุฉ)

Guardian (ููู ููู ุงูุฃูุฑ)
โโโ Id
โโโ UserId โ User (ุญุณุงุจ ููู ุงูุฃูุฑ - nullable)
โโโ FullName
โโโ Phone
โโโ Students (ุงูุทูุงุจ ุงููุณุคูู ุนููู)
```

---

## ๐จ ุงููุฒุงูุง:

โ **ูุฑููุฉ ุนุงููุฉ:** ููุณ ุงูุดุฎุต ูููู ุฃู ูููู ุทุงูุจุงู ูููู ุฃูุฑ ูู ููุณ ุงูููุช  
โ **ูุถูุญ ุงูุฃุฏูุงุฑ:** ูู ุฏูุฑ ูู ููู ูููุตู (Student, Guardian, Teacher)  
โ **ุณูููุฉ ุงูุฅุฏุงุฑุฉ:** ูููู ูููู ุงูุฃูุฑ ุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุฃุทูุงูู ูู ุญุณุงุจู  
โ **ุฎุตูุตูุฉ:** ูู ุทุงูุจ ูู ุญุณุงุจ `User` ูููุตู (ุญุชู ูู ูุงู ูุงุตุฑ)  
โ **ูุงุจููุฉ ุงูุชูุณุน:** ุณูููุฉ ุฅุถุงูุฉ ุฃุฏูุงุฑ ุฌุฏูุฏุฉ ูุณุชูุจูุงู (Teacher, Admin, ...)  

---

## ๐ ุงูููุงุนุฏ ูุงูุชุญููุงุช:

```csharp
// 1. ุฅุฐุง ูุงู ุงูุทุงูุจ ูุงุตุฑุ ูุฌุจ ุฃู ูููู ูู Guardian
if (student.IsMinor && student.GuardianId == null)
    throw new ValidationException("ุงููุงุตุฑ ูุญุชุงุฌ ููู ุฃูุฑ");

// 2. ุฅุฐุง ูุงู ุงูุทุงูุจ ุจุงูุบุ ูุง ูุญุชุงุฌ Guardian
if (!student.IsMinor && student.GuardianId != null)
    throw new ValidationException("ุงูุทุงูุจ ุงูุจุงูุบ ูุง ูุญุชุงุฌ ููู ุฃูุฑ");

// 3. Guardian ูุฌุจ ุฃู ูููู ูู UserId ุฃู ูุนูููุงุช ุงุชุตุงู ูุงููุฉ
if (guardian.UserId == null && 
    (string.IsNullOrEmpty(guardian.Phone) || string.IsNullOrEmpty(guardian.FullName)))
    throw new ValidationException("ูุฌุจ ุชูููุฑ ูุนูููุงุช ููู ุงูุฃูุฑ");

// 4. ูุง ูููู ููุทุงูุจ ุฃู ูููู ููู ุฃูุฑ ูููุณู
if (student.UserId == guardian.UserId && student.GuardianId == guardian.Id)
    throw new ValidationException("ุงูุทุงูุจ ูุง ูููู ุฃู ูููู ููู ุฃูุฑ ูููุณู");
```

---

## ๐ก ููุงุญุธุฉ ูููุฉ:

`Guardian.UserId` ูููู ุฃู ูููู **nullable** ูุณุจุจ ููู:  
- ุฅุฐุง ูุงู ููู ุงูุฃูุฑ **ูุฏูู ุญุณุงุจ** ูู ุงููุธุงู โ `UserId` ููููุก
- ุฅุฐุง ูุงู ููู ุงูุฃูุฑ **ููุณ ูุฏูู ุญุณุงุจ** (ูุฌุฑุฏ ูุนูููุงุช ุงุชุตุงู) โ `UserId = null`

ูุฐุง ูุนุทู **ูุฑููุฉ ุฃูุจุฑ** ูููุธุงู โจ

---

ูู ุชุฑูุฏ ููู ุชูุถูุญ ุฃู ุฌุฒุก ุฃูุซุฑ ุฃู ุชุฑูุฏ ุฑุคูุฉ ุฃูุซูุฉ ููุฏ ููุชุทุจููุ